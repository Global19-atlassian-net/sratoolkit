GAS LISTING /tmp/ccIWwvs6.s 			page 1


   1              		.file	"cipher-vec.c"
   2              		.text
   3              		.p2align 4,,15
   4              		.type	KCipherVecAesNiSetEncryptKey, @function
   5              	KCipherVecAesNiSetEncryptKey:
   6              	.LFB669:
   7              		.cfi_startproc
   8 0000 4883EC08 		subq	$8, %rsp
   9              		.cfi_def_cfa_offset 16
  10 0004 488B4F48 		movq	72(%rdi), %rcx
  11 0008 B8088E04 		movl	$-2029744632, %eax
  11      87
  12 000d 833901   		cmpl	$1, (%rcx)
  13 0010 7509     		jne	.L4
  14 0012 488B7F18 		movq	24(%rdi), %rdi
  15 0016 FF5120   		call	*32(%rcx)
  16 0019 31C0     		xorl	%eax, %eax
  17              	.L4:
  18 001b 4883C408 		addq	$8, %rsp
  19 001f C3       		ret
  20              		.cfi_endproc
  21              	.LFE669:
  22              		.size	KCipherVecAesNiSetEncryptKey, .-KCipherVecAesNiSetEncryptKey
  23              		.p2align 4,,15
  24              		.type	KCipherVecAesNiSetDecryptKey, @function
  25              	KCipherVecAesNiSetDecryptKey:
  26              	.LFB670:
  27              		.cfi_startproc
  28 0020 4883EC08 		subq	$8, %rsp
  29              		.cfi_def_cfa_offset 16
  30 0024 488B4F48 		movq	72(%rdi), %rcx
  31 0028 B8088E04 		movl	$-2029744632, %eax
  31      87
  32 002d 833901   		cmpl	$1, (%rcx)
  33 0030 7509     		jne	.L10
  34 0032 488B7F20 		movq	32(%rdi), %rdi
  35 0036 FF5128   		call	*40(%rcx)
  36 0039 31C0     		xorl	%eax, %eax
  37              	.L10:
  38 003b 4883C408 		addq	$8, %rsp
  39 003f C3       		ret
  40              		.cfi_endproc
  41              	.LFE670:
  42              		.size	KCipherVecAesNiSetDecryptKey, .-KCipherVecAesNiSetDecryptKey
  43              		.p2align 4,,15
  44              		.type	KCipherVecAesNiSetEncryptCounterFunc, @function
  45              	KCipherVecAesNiSetEncryptCounterFunc:
  46              	.LFB673:
  47              		.cfi_startproc
  48 0040 48897738 		movq	%rsi, 56(%rdi)
  49 0044 31C0     		xorl	%eax, %eax
  50 0046 C3       		ret
  51              		.cfi_endproc
  52              	.LFE673:
  53              		.size	KCipherVecAesNiSetEncryptCounterFunc, .-KCipherVecAesNiSetEncryptCounterFunc
  54 0047 660F1F84 		.p2align 4,,15
  54      00000000 
GAS LISTING /tmp/ccIWwvs6.s 			page 2


  54      00
  55              		.type	KCipherVecAesNiSetDecryptCounterFunc, @function
  56              	KCipherVecAesNiSetDecryptCounterFunc:
  57              	.LFB674:
  58              		.cfi_startproc
  59 0050 48897740 		movq	%rsi, 64(%rdi)
  60 0054 31C0     		xorl	%eax, %eax
  61 0056 C3       		ret
  62              		.cfi_endproc
  63              	.LFE674:
  64              		.size	KCipherVecAesNiSetDecryptCounterFunc, .-KCipherVecAesNiSetDecryptCounterFunc
  65 0057 660F1F84 		.p2align 4,,15
  65      00000000 
  65      00
  66              		.type	KCipherVecAesNiEncrypt, @function
  67              	KCipherVecAesNiEncrypt:
  68              	.LFB679:
  69              		.cfi_startproc
  70 0060 53       		pushq	%rbx
  71              		.cfi_def_cfa_offset 16
  72 0061 4C8B4748 		movq	72(%rdi), %r8
  73 0065 4889F9   		movq	%rdi, %rcx
  74 0068 4889D3   		movq	%rdx, %rbx
  75              		.cfi_offset 3, -16
  76 006b B8080E09 		movl	$-2029449720, %eax
  76      87
  77 0070 41833801 		cmpl	$1, (%r8)
  78 0074 740A     		je	.L21
  79 0076 5B       		popq	%rbx
  80 0077 C3       		ret
  81 0078 0F1F8400 		.p2align 4,,10
  81      00000000 
  82              		.p2align 3
  83              	.L21:
  84 0080 4889F7   		movq	%rsi, %rdi
  85              	#APP
  86              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
   1              	/*===========================================================================
   2              	 *
   3              	 *                            PUBLIC DOMAIN NOTICE
   4              	 *               National Center for Biotechnology Information
   5              	 *
   6              	 *  This software/database is a "United States Government Work" under the
   7              	 *  terms of the United States Copyright Act.  It was written as part of
   8              	 *  the author's official duties as a United States Government employee and
   9              	 *  thus cannot be copyrighted.  This software/database is freely available
  10              	 *  to the public for use. The National Library of Medicine and the U.S.
  11              	 *  Government have not placed any restriction on its use or reproduction.
  12              	 *
  13              	 *  Although all reasonable efforts have been taken to ensure the accuracy
  14              	 *  and reliability of the software and data, the NLM and the U.S.
  15              	 *  Government do not and cannot warrant the performance or results that
  16              	 *  may be obtained by using this software or data. The NLM and the U.S.
  17              	 *  Government disclaim all warranties, express or implied, including
  18              	 *  warranties of performance, merchantability or fitness for any particular
  19              	 *  purpose.
  20              	 *
GAS LISTING /tmp/ccIWwvs6.s 			page 3


  21              	 *  Please cite the author in any work or product based on this material.
  22              	 *
  23              	 * ===========================================================================
  24              	 */
  25              	
  26              	#include <krypto/extern.h>
  27              	#include <klib/defs.h>
  28              	
  29              	/* CIPHER_IMPL and BLOCKCIPHER_IMPL are defined in this header */
  30              	#include "ncbi-priv.h"
  31              	/* CIPHER_IMPL is used in this header */
  32              	#include "cipher-impl.h"
  33              	/* BLOCKCIPHER_IMPL is used in this header */
  34              	#include "blockcipher-impl.h"
  35              	
  36              	#include "aes-ncbi-priv.h"
  37              	#include "null-ncbi-priv.h"
  38              	#include "cipher-priv.h"
  39              	#include "blockcipher-priv.h"
  40              	
  41              	#include <krypto/cipher.h>
  42              	#include <krypto/ciphermgr.h>
  43              	
  44              	#include <klib/defs.h>
  45              	#include <klib/refcount.h>
  46              	#include <klib/out.h>
  47              	#include <klib/rc.h>
  48              	
  49              	#include <stdlib.h>
  50              	#include <string.h>
  51              	#include <assert.h>
  52              	
  53              	
  54              	const char CMEMBER(ClassName)[] = CLASS_STRING(CIPHER_IMPL);
  55              	
  56              	
  57              	
  58              	struct CIPHER_IMPL
  59              	{
  60              	    KCipher dad;
  61              	    const KBlockCipherVec * block_cipher;
  62              	};
  63              	
  64              	typedef union CipherVec_u
  65              	{
  66              	    CipherVec   vec;
  67              	    CipherBlock block;
  68              	} CipherVec_u;
  69              	
  70              	/*
  71              	 * Read a blocks worth of bytes into an AESState
  72              	 */
  73              	static __inline__ CipherVec CipherVecIn (const void * cvin)
  74              	{
  75              	#if USE_VEC_REG
  76              	    register CipherVec cv;
  77              	
GAS LISTING /tmp/ccIWwvs6.s 			page 4


  78 0083 F30F6F07 	    __asm__ (
  79              	        "movdqu (%[a]),%[s]" : [s] "=x" (cv) : [a] "D" (cvin)
  87              		movdqu (%rdi),%xmm0
  88              	# 0 "" 2
  89              	#NO_APP
  90 0087 488B7918 		movq	24(%rcx), %rdi
  91 008b 41FF5030 		call	*48(%r8)
  92 008f 4889DF   		movq	%rbx, %rdi
  93              	#APP
  94              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
  80              	        );
  81              	
  82              	    return cv;
  83              	#else
  84              	    CipherVec_u u;
  85              	
  86              	    memmove (&u.block, cvin, sizeof (u));
  87              	    return u.vec;
  88              	#endif
  89              	}
  90              	
  91              	
  92              	
  93              	/*
  94              	 * Write a block's worth of bytes out from an AESState
  95              	 */
  96              	static __inline__ void CipherVecOut (const CipherVec cv, void * cvout)
  97              	{
  98              	#if USE_VEC_REG
  99              	    register CipherVec rcv = cv;
 100              	
 101 0092 F30F7F07 	    __asm__ (
 102              	        "movdqu %[s],(%[a])" : : [s] "x" (rcv), [a] "D" (cvout)
  95              		movdqu %xmm0,(%rdi)
  96              	# 0 "" 2
  97              	#NO_APP
  98 0096 31C0     		xorl	%eax, %eax
  99 0098 5B       		popq	%rbx
 100 0099 C3       		ret
 101              		.cfi_endproc
 102              	.LFE679:
 103              		.size	KCipherVecAesNiEncrypt, .-KCipherVecAesNiEncrypt
 104 009a 660F1F44 		.p2align 4,,15
 104      0000
 105              		.type	KCipherVecAesNiDecrypt, @function
 106              	KCipherVecAesNiDecrypt:
 107              	.LFB680:
 108              		.cfi_startproc
 109 00a0 53       		pushq	%rbx
 110              		.cfi_def_cfa_offset 16
 111 00a1 4C8B4748 		movq	72(%rdi), %r8
 112 00a5 4889F9   		movq	%rdi, %rcx
 113 00a8 4889D3   		movq	%rdx, %rbx
 114              		.cfi_offset 3, -16
 115 00ab B8080E09 		movl	$-2029449720, %eax
 115      87
 116 00b0 41833801 		cmpl	$1, (%r8)
GAS LISTING /tmp/ccIWwvs6.s 			page 5


 117 00b4 740A     		je	.L27
 118 00b6 5B       		popq	%rbx
 119 00b7 C3       		ret
 120 00b8 0F1F8400 		.p2align 4,,10
 120      00000000 
 121              		.p2align 3
 122              	.L27:
 123 00c0 4889F7   		movq	%rsi, %rdi
 124              	#APP
 125              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 126              		movdqu (%rdi),%xmm0
 127              	# 0 "" 2
 128              	#NO_APP
 129 00c7 488B7920 		movq	32(%rcx), %rdi
 130 00cb 41FF5038 		call	*56(%r8)
 131 00cf 4889DF   		movq	%rbx, %rdi
 132              	#APP
 133              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 134              		movdqu %xmm0,(%rdi)
 135              	# 0 "" 2
 136              	#NO_APP
 137 00d6 31C0     		xorl	%eax, %eax
 138 00d8 5B       		popq	%rbx
 139 00d9 C3       		ret
 140              		.cfi_endproc
 141              	.LFE680:
 142              		.size	KCipherVecAesNiDecrypt, .-KCipherVecAesNiDecrypt
 143 00da 660F1F44 		.p2align 4,,15
 143      0000
 144              		.type	KCipherVecAesNiDecryptEcb, @function
 145              	KCipherVecAesNiDecryptEcb:
 146              	.LFB682:
 147              		.cfi_startproc
 148 00e0 4155     		pushq	%r13
 149              		.cfi_def_cfa_offset 16
 150 00e2 4154     		pushq	%r12
 151              		.cfi_def_cfa_offset 24
 152 00e4 55       		pushq	%rbp
 153              		.cfi_def_cfa_offset 32
 154 00e5 89CD     		movl	%ecx, %ebp
 155              		.cfi_offset 6, -32
 156              		.cfi_offset 12, -24
 157              		.cfi_offset 13, -16
 158 00e7 53       		pushq	%rbx
 159              		.cfi_def_cfa_offset 40
 160 00e8 4889FB   		movq	%rdi, %rbx
 161              		.cfi_offset 3, -40
 162 00eb 4883EC08 		subq	$8, %rsp
 163              		.cfi_def_cfa_offset 48
 164 00ef 85C9     		testl	%ecx, %ecx
 165 00f1 7434     		je	.L29
 166 00f3 4989F5   		movq	%rsi, %r13
 167 00f6 4989D4   		movq	%rdx, %r12
 168 00f9 0F1F8000 		.p2align 4,,10
 168      000000
 169              		.p2align 3
 170              	.L30:
GAS LISTING /tmp/ccIWwvs6.s 			page 6


 171 0100 488B4348 		movq	72(%rbx), %rax
 172 0104 4C89EF   		movq	%r13, %rdi
 173              	#APP
 174              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 175              		movdqu (%rdi),%xmm0
 176              	# 0 "" 2
 177              	#NO_APP
 178 010b 488B7B20 		movq	32(%rbx), %rdi
 179 010f FF5038   		call	*56(%rax)
 180 0112 4C89E7   		movq	%r12, %rdi
 181              	#APP
 182              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 183              		movdqu %xmm0,(%rdi)
 184              	# 0 "" 2
 185              	#NO_APP
 186 0119 8B4304   		mov	4(%rbx), %eax
 187 011c 4901C5   		addq	%rax, %r13
 188 011f 4901C4   		addq	%rax, %r12
 189 0122 83ED01   		subl	$1, %ebp
 190 0125 75D9     		jne	.L30
 191              	.L29:
 192 0127 4883C408 		addq	$8, %rsp
 193 012b 31C0     		xorl	%eax, %eax
 194 012d 5B       		popq	%rbx
 195 012e 5D       		popq	%rbp
 196 012f 415C     		popq	%r12
 197 0131 415D     		popq	%r13
 198 0133 C3       		ret
 199              		.cfi_endproc
 200              	.LFE682:
 201              		.size	KCipherVecAesNiDecryptEcb, .-KCipherVecAesNiDecryptEcb
 202 0134 6666662E 		.p2align 4,,15
 202      0F1F8400 
 202      00000000 
 203              		.type	KCipherVecAesNiDecryptCbc, @function
 204              	KCipherVecAesNiDecryptCbc:
 205              	.LFB684:
 206              		.cfi_startproc
 207 0140 4155     		pushq	%r13
 208              		.cfi_def_cfa_offset 16
 209 0142 4154     		pushq	%r12
 210              		.cfi_def_cfa_offset 24
 211 0144 55       		pushq	%rbp
 212              		.cfi_def_cfa_offset 32
 213 0145 89CD     		movl	%ecx, %ebp
 214              		.cfi_offset 6, -32
 215              		.cfi_offset 12, -24
 216              		.cfi_offset 13, -16
 217 0147 53       		pushq	%rbx
 218              		.cfi_def_cfa_offset 40
 219 0148 4889FB   		movq	%rdi, %rbx
 220              		.cfi_offset 3, -40
 221 014b 4883EC28 		subq	$40, %rsp
 222              		.cfi_def_cfa_offset 80
 223 014f 488B7F30 		movq	48(%rdi), %rdi
 224              	#APP
 225              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
GAS LISTING /tmp/ccIWwvs6.s 			page 7


 226              		movdqu (%rdi),%xmm2
 227              	# 0 "" 2
 228              	#NO_APP
 229 0157 85C9     		testl	%ecx, %ecx
 230 0159 745A     		je	.L34
 231 015b 4989F5   		movq	%rsi, %r13
 232 015e 4989D4   		movq	%rdx, %r12
 233              		.p2align 4,,10
 234 0161 0F1F8000 		.p2align 3
 234      000000
 235              	.L35:
 236 0168 488B4348 		movq	72(%rbx), %rax
 237 016c 4C89EF   		movq	%r13, %rdi
 238 016f 660F7F54 		movdqa	%xmm2, 16(%rsp)
 238      2410
 239              	#APP
 240              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 241              		movdqu (%rdi),%xmm1
 242              	# 0 "" 2
 243              	#NO_APP
 244 0179 660F6FC1 		movdqa	%xmm1, %xmm0
 245 017d 660F7F0C 		movdqa	%xmm1, (%rsp)
 245      24
 246 0182 488B7B20 		movq	32(%rbx), %rdi
 247 0186 FF5038   		call	*56(%rax)
 248 0189 4C89E7   		movq	%r12, %rdi
 249 018c 660F6F54 		movdqa	16(%rsp), %xmm2
 249      2410
 250 0192 660FEFC2 		pxor	%xmm2, %xmm0
 251              	#APP
 252              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 253              		movdqu %xmm0,(%rdi)
 254              	# 0 "" 2
 255              	#NO_APP
 256 019a 8B4304   		mov	4(%rbx), %eax
 257 019d 660F6F0C 		movdqa	(%rsp), %xmm1
 257      24
 258 01a2 660F6FD1 		movdqa	%xmm1, %xmm2
 259 01a6 4901C5   		addq	%rax, %r13
 260 01a9 4901C4   		addq	%rax, %r12
 261 01ac 83ED01   		subl	$1, %ebp
 262 01af 75B7     		jne	.L35
 263 01b1 488B7B30 		movq	48(%rbx), %rdi
 264              	.L34:
 265 01b5 660F7F17 		movdqa	%xmm2, (%rdi)
 266 01b9 4883C428 		addq	$40, %rsp
 267 01bd 31C0     		xorl	%eax, %eax
 268 01bf 5B       		popq	%rbx
 269 01c0 5D       		popq	%rbp
 270 01c1 415C     		popq	%r12
 271 01c3 415D     		popq	%r13
 272 01c5 C3       		ret
 273              		.cfi_endproc
 274              	.LFE684:
 275              		.size	KCipherVecAesNiDecryptCbc, .-KCipherVecAesNiDecryptCbc
 276 01c6 662E0F1F 		.p2align 4,,15
 276      84000000 
GAS LISTING /tmp/ccIWwvs6.s 			page 8


 276      0000
 277              		.type	KCipherVecAesNiDecryptPcbc, @function
 278              	KCipherVecAesNiDecryptPcbc:
 279              	.LFB686:
 280              		.cfi_startproc
 281 01d0 4155     		pushq	%r13
 282              		.cfi_def_cfa_offset 16
 283 01d2 4154     		pushq	%r12
 284              		.cfi_def_cfa_offset 24
 285 01d4 55       		pushq	%rbp
 286              		.cfi_def_cfa_offset 32
 287 01d5 89CD     		movl	%ecx, %ebp
 288              		.cfi_offset 6, -32
 289              		.cfi_offset 12, -24
 290              		.cfi_offset 13, -16
 291 01d7 53       		pushq	%rbx
 292              		.cfi_def_cfa_offset 40
 293 01d8 4889FB   		movq	%rdi, %rbx
 294              		.cfi_offset 3, -40
 295 01db 4883EC18 		subq	$24, %rsp
 296              		.cfi_def_cfa_offset 64
 297 01df 488B4728 		movq	40(%rdi), %rax
 298 01e3 85C9     		testl	%ecx, %ecx
 299 01e5 660F6F08 		movdqa	(%rax), %xmm1
 300 01e9 7446     		je	.L39
 301 01eb 4989F5   		movq	%rsi, %r13
 302 01ee 4989D4   		movq	%rdx, %r12
 303              		.p2align 4,,10
 304 01f1 0F1F8000 		.p2align 3
 304      000000
 305              	.L40:
 306 01f8 488B4348 		movq	72(%rbx), %rax
 307 01fc 4C89EF   		movq	%r13, %rdi
 308 01ff 660F7F0C 		movdqa	%xmm1, (%rsp)
 308      24
 309              	#APP
 310              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 311              		movdqu (%rdi),%xmm0
 312              	# 0 "" 2
 313              	#NO_APP
 314 0208 488B7B20 		movq	32(%rbx), %rdi
 315 020c FF5038   		call	*56(%rax)
 316 020f 660F6F0C 		movdqa	(%rsp), %xmm1
 316      24
 317 0214 4C89E7   		movq	%r12, %rdi
 318 0217 660FEFC8 		pxor	%xmm0, %xmm1
 319              	#APP
 320              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 321              		movdqu %xmm0,(%rdi)
 322              	# 0 "" 2
 323              	#NO_APP
 324 021f 8B4304   		mov	4(%rbx), %eax
 325 0222 4901C5   		addq	%rax, %r13
 326 0225 4901C4   		addq	%rax, %r12
 327 0228 83ED01   		subl	$1, %ebp
 328 022b 75CB     		jne	.L40
 329 022d 488B4328 		movq	40(%rbx), %rax
GAS LISTING /tmp/ccIWwvs6.s 			page 9


 330              	.L39:
 331 0231 660F7F08 		movdqa	%xmm1, (%rax)
 332 0235 4883C418 		addq	$24, %rsp
 333 0239 31C0     		xorl	%eax, %eax
 334 023b 5B       		popq	%rbx
 335 023c 5D       		popq	%rbp
 336 023d 415C     		popq	%r12
 337 023f 415D     		popq	%r13
 338 0241 C3       		ret
 339              		.cfi_endproc
 340              	.LFE686:
 341              		.size	KCipherVecAesNiDecryptPcbc, .-KCipherVecAesNiDecryptPcbc
 342 0242 66666666 		.p2align 4,,15
 342      662E0F1F 
 342      84000000 
 342      0000
 343              		.type	KCipherVecAesNiEncryptCtr, @function
 344              	KCipherVecAesNiEncryptCtr:
 345              	.LFB691:
 346              		.cfi_startproc
 347 0250 B8030509 		movl	$-2029452029, %eax
 347      87
 348 0255 C3       		ret
 349              		.cfi_endproc
 350              	.LFE691:
 351              		.size	KCipherVecAesNiEncryptCtr, .-KCipherVecAesNiEncryptCtr
 352 0256 662E0F1F 		.p2align 4,,15
 352      84000000 
 352      0000
 353              		.type	KCipherVecAesNiDecryptCtr, @function
 354              	KCipherVecAesNiDecryptCtr:
 355              	.LFB692:
 356              		.cfi_startproc
 357 0260 B8030509 		movl	$-2029452029, %eax
 357      87
 358 0265 C3       		ret
 359              		.cfi_endproc
 360              	.LFE692:
 361              		.size	KCipherVecAesNiDecryptCtr, .-KCipherVecAesNiDecryptCtr
 362 0266 662E0F1F 		.p2align 4,,15
 362      84000000 
 362      0000
 363              	.globl KCipherVecAesNiMake
 364              		.type	KCipherVecAesNiMake, @function
 365              	KCipherVecAesNiMake:
 366              	.LFB697:
 367              		.cfi_startproc
 368 0270 48895C24 		movq	%rbx, -32(%rsp)
 368      E0
 369 0275 48896C24 		movq	%rbp, -24(%rsp)
 369      E8
 370 027a BB878F00 		movl	$-2030006393, %ebx
 370      87
 371              		.cfi_offset 6, -32
 372              		.cfi_offset 3, -40
 373 027f 4C896424 		movq	%r12, -16(%rsp)
 373      F0
GAS LISTING /tmp/ccIWwvs6.s 			page 10


 374 0284 4C896C24 		movq	%r13, -8(%rsp)
 374      F8
 375 0289 4883EC38 		subq	$56, %rsp
 376              		.cfi_def_cfa_offset 64
 377 028d 4885FF   		testq	%rdi, %rdi
 378 0290 4889FD   		movq	%rdi, %rbp
 379 0293 4189F4   		movl	%esi, %r12d
 380              		.cfi_offset 13, -16
 381              		.cfi_offset 12, -24
 382 0296 0F849400 		je	.L49
 382      0000
 383 029c 85F6     		testl	%esi, %esi
 384 029e 48C70700 		movq	$0, (%rdi)
 384      000000
 385 02a5 0F85A500 		jne	.L61
 385      0000
 386 02ab 488D7C24 		leaq	8(%rsp), %rdi
 386      08
 387 02b0 E8000000 		call	KNullBlockCipherVecAesNiMake@PLT
 387      00
 388 02b5 89C3     		movl	%eax, %ebx
 389              	.L53:
 390 02b7 85DB     		testl	%ebx, %ebx
 391 02b9 7575     		jne	.L49
 392 02bb 4585E4   		testl	%r12d, %r12d
 393 02be 0F85AC00 		jne	.L62
 393      0000
 394 02c4 BE700000 		movl	$112, %esi
 394      00
 395 02c9 BF010000 		movl	$1, %edi
 395      00
 396 02ce E8000000 		call	calloc@PLT
 396      00
 397 02d3 4885C0   		testq	%rax, %rax
 398 02d6 4989C4   		movq	%rax, %r12
 399 02d9 0F841101 		je	.L56
 399      0000
 400 02df 488B0D00 		movq	KCipherVecAesNiClassName@GOTPCREL(%rip), %rcx
 400      000000
 401 02e6 488D1500 		leaq	KCipherVecAesNi_vt_v1(%rip), %rdx
 401      000000
 402 02ed 4C8B6C24 		movq	8(%rsp), %r13
 402      08
 403 02f2 4889C7   		movq	%rax, %rdi
 404 02f5 BE100000 		movl	$16, %esi
 404      00
 405 02fa E8000000 		call	KCipherInit@PLT
 405      00
 406 02ff 498D5424 		leaq	80(%r12), %rdx
 406      50
 407 0304 498D4424 		leaq	96(%r12), %rax
 407      60
 408 0309 4D896C24 		movq	%r13, 72(%r12)
 408      48
 409 030e 49895424 		movq	%rdx, 24(%r12)
 409      18
 410 0313 49894424 		movq	%rax, 32(%r12)
GAS LISTING /tmp/ccIWwvs6.s 			page 11


 410      20
 411 0318 49895424 		movq	%rdx, 40(%r12)
 411      28
 412 031d 49894424 		movq	%rax, 48(%r12)
 412      30
 413 0322 4C896500 		movq	%r12, (%rbp)
 414 0326 662E0F1F 		.p2align 4,,10
 414      84000000 
 414      0000
 415              		.p2align 3
 416              	.L49:
 417 0330 89D8     		movl	%ebx, %eax
 418 0332 488B6C24 		movq	32(%rsp), %rbp
 418      20
 419 0337 488B5C24 		movq	24(%rsp), %rbx
 419      18
 420 033c 4C8B6424 		movq	40(%rsp), %r12
 420      28
 421 0341 4C8B6C24 		movq	48(%rsp), %r13
 421      30
 422 0346 4883C438 		addq	$56, %rsp
 423 034a C3       		ret
 424 034b 0F1F4400 		.p2align 4,,10
 424      00
 425              		.p2align 3
 426              	.L61:
 427 0350 83FE01   		cmpl	$1, %esi
 428 0353 BBCA8F00 		movl	$-2030006326, %ebx
 428      87
 429 0358 75D6     		jne	.L49
 430 035a 488D7C24 		leaq	8(%rsp), %rdi
 430      08
 431 035f E8000000 		call	KAESBlockCipherVecAesNiMake@PLT
 431      00
 432 0364 89C3     		movl	%eax, %ebx
 433 0366 E94CFFFF 		jmp	.L53
 433      FF
 434 036b 0F1F4400 		.p2align 4,,10
 434      00
 435              		.p2align 3
 436              	.L62:
 437 0370 4183FC01 		cmpl	$1, %r12d
 438 0374 75BA     		jne	.L49
 439 0376 BE700200 		movl	$624, %esi
 439      00
 440 037b BF010000 		movl	$1, %edi
 440      00
 441 0380 E8000000 		call	calloc@PLT
 441      00
 442 0385 4885C0   		testq	%rax, %rax
 443 0388 4989C4   		movq	%rax, %r12
 444 038b 7463     		je	.L56
 445 038d 488B0D00 		movq	KCipherVecAesNiClassName@GOTPCREL(%rip), %rcx
 445      000000
 446 0394 488D1500 		leaq	KCipherVecAesNi_vt_v1(%rip), %rdx
 446      000000
 447 039b 4889C7   		movq	%rax, %rdi
GAS LISTING /tmp/ccIWwvs6.s 			page 12


 448 039e BE100000 		movl	$16, %esi
 448      00
 449 03a3 4C8B6C24 		movq	8(%rsp), %r13
 449      08
 450 03a8 E8000000 		call	KCipherInit@PLT
 450      00
 451 03ad 498D4424 		leaq	80(%r12), %rax
 451      50
 452 03b2 4D896C24 		movq	%r13, 72(%r12)
 452      48
 453 03b7 49894424 		movq	%rax, 24(%r12)
 453      18
 454 03bc 498D8424 		leaq	336(%r12), %rax
 454      50010000 
 455 03c4 49894424 		movq	%rax, 32(%r12)
 455      20
 456 03c9 498D8424 		leaq	592(%r12), %rax
 456      50020000 
 457 03d1 49894424 		movq	%rax, 40(%r12)
 457      28
 458 03d6 498D8424 		leaq	608(%r12), %rax
 458      60020000 
 459 03de 49894424 		movq	%rax, 48(%r12)
 459      30
 460 03e3 4C896500 		movq	%r12, (%rbp)
 461 03e7 E944FFFF 		jmp	.L49
 461      FF
 462 03ec 0F1F4000 		.p2align 4,,10
 463              		.p2align 3
 464              	.L56:
 465 03f0 BB539000 		movl	$-2030006189, %ebx
 465      87
 466 03f5 E936FFFF 		jmp	.L49
 466      FF
 467              		.cfi_endproc
 468              	.LFE697:
 469              		.size	KCipherVecAesNiMake, .-KCipherVecAesNiMake
 470 03fa 660F1F44 		.p2align 4,,15
 470      0000
 471              		.type	KCipherVecAesNiSetDecryptIvec, @function
 472              	KCipherVecAesNiSetDecryptIvec:
 473              	.LFB672:
 474              		.cfi_startproc
 475 0400 4889F8   		movq	%rdi, %rax
 476 0403 4883EC08 		subq	$8, %rsp
 477              		.cfi_def_cfa_offset 16
 478 0407 488B7F30 		movq	48(%rdi), %rdi
 479 040b 8B5004   		mov	4(%rax), %edx
 480 040e E8000000 		call	memcpy@PLT
 480      00
 481 0413 31C0     		xorl	%eax, %eax
 482 0415 4883C408 		addq	$8, %rsp
 483 0419 C3       		ret
 484              		.cfi_endproc
 485              	.LFE672:
 486              		.size	KCipherVecAesNiSetDecryptIvec, .-KCipherVecAesNiSetDecryptIvec
 487 041a 660F1F44 		.p2align 4,,15
GAS LISTING /tmp/ccIWwvs6.s 			page 13


 487      0000
 488              		.type	KCipherVecAesNiSetEncryptIvec, @function
 489              	KCipherVecAesNiSetEncryptIvec:
 490              	.LFB671:
 491              		.cfi_startproc
 492 0420 4889F8   		movq	%rdi, %rax
 493 0423 4883EC08 		subq	$8, %rsp
 494              		.cfi_def_cfa_offset 16
 495 0427 488B7F28 		movq	40(%rdi), %rdi
 496 042b 8B5004   		mov	4(%rax), %edx
 497 042e E8000000 		call	memcpy@PLT
 497      00
 498 0433 31C0     		xorl	%eax, %eax
 499 0435 4883C408 		addq	$8, %rsp
 500 0439 C3       		ret
 501              		.cfi_endproc
 502              	.LFE671:
 503              		.size	KCipherVecAesNiSetEncryptIvec, .-KCipherVecAesNiSetEncryptIvec
 504 043a 660F1F44 		.p2align 4,,15
 504      0000
 505              		.type	KCipherVecAesNiDestroy, @function
 506              	KCipherVecAesNiDestroy:
 507              	.LFB668:
 508              		.cfi_startproc
 509 0440 48895C24 		movq	%rbx, -16(%rsp)
 509      F0
 510 0445 48896C24 		movq	%rbp, -8(%rsp)
 510      F8
 511 044a 4883EC18 		subq	$24, %rsp
 512              		.cfi_def_cfa_offset 32
 513 044e 31ED     		xorl	%ebp, %ebp
 514              		.cfi_offset 6, -16
 515              		.cfi_offset 3, -24
 516 0450 4885FF   		testq	%rdi, %rdi
 517 0453 4889FB   		movq	%rdi, %rbx
 518 0456 740F     		je	.L69
 519 0458 E8000000 		call	KCipherDestroy@PLT
 519      00
 520 045d 4889DF   		movq	%rbx, %rdi
 521 0460 89C5     		movl	%eax, %ebp
 522 0462 E8000000 		call	free@PLT
 522      00
 523              	.L69:
 524 0467 89E8     		movl	%ebp, %eax
 525 0469 488B5C24 		movq	8(%rsp), %rbx
 525      08
 526 046e 488B6C24 		movq	16(%rsp), %rbp
 526      10
 527 0473 4883C418 		addq	$24, %rsp
 528 0477 C3       		ret
 529              		.cfi_endproc
 530              	.LFE668:
 531              		.size	KCipherVecAesNiDestroy, .-KCipherVecAesNiDestroy
 532 0478 0F1F8400 		.p2align 4,,15
 532      00000000 
 533              		.type	KCipherVecAesNiEncryptOfb, @function
 534              	KCipherVecAesNiEncryptOfb:
GAS LISTING /tmp/ccIWwvs6.s 			page 14


 535              	.LFB689:
 536              		.cfi_startproc
 537 0480 4155     		pushq	%r13
 538              		.cfi_def_cfa_offset 16
 539 0482 4154     		pushq	%r12
 540              		.cfi_def_cfa_offset 24
 541 0484 55       		pushq	%rbp
 542              		.cfi_def_cfa_offset 32
 543 0485 89CD     		movl	%ecx, %ebp
 544              		.cfi_offset 6, -32
 545              		.cfi_offset 12, -24
 546              		.cfi_offset 13, -16
 547 0487 53       		pushq	%rbx
 548              		.cfi_def_cfa_offset 40
 549 0488 4889FB   		movq	%rdi, %rbx
 550              		.cfi_offset 3, -40
 551 048b 4883EC08 		subq	$8, %rsp
 552              		.cfi_def_cfa_offset 48
 553 048f 488B4728 		movq	40(%rdi), %rax
 554 0493 85C9     		testl	%ecx, %ecx
 555 0495 660F6F00 		movdqa	(%rax), %xmm0
 556 0499 743C     		je	.L72
 557 049b 4989F5   		movq	%rsi, %r13
 558 049e 4989D4   		movq	%rdx, %r12
 559              		.p2align 4,,10
 560 04a1 0F1F8000 		.p2align 3
 560      000000
 561              	.L73:
 562 04a8 488B4348 		movq	72(%rbx), %rax
 563 04ac 488B7B18 		movq	24(%rbx), %rdi
 564 04b0 FF5030   		call	*48(%rax)
 565 04b3 4C89EF   		movq	%r13, %rdi
 566              	#APP
 567              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 568              		movdqu (%rdi),%xmm1
 569              	# 0 "" 2
 570              	#NO_APP
 571 04ba 4C89E7   		movq	%r12, %rdi
 572 04bd 660FEFC8 		pxor	%xmm0, %xmm1
 573              	#APP
 574              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 575              		movdqu %xmm1,(%rdi)
 576              	# 0 "" 2
 577              	#NO_APP
 578 04c5 8B4304   		mov	4(%rbx), %eax
 579 04c8 4901C5   		addq	%rax, %r13
 580 04cb 4901C4   		addq	%rax, %r12
 581 04ce 83ED01   		subl	$1, %ebp
 582 04d1 75D5     		jne	.L73
 583 04d3 488B4328 		movq	40(%rbx), %rax
 584              	.L72:
 585 04d7 660F7F00 		movdqa	%xmm0, (%rax)
 586 04db 4883C408 		addq	$8, %rsp
 587 04df 31C0     		xorl	%eax, %eax
 588 04e1 5B       		popq	%rbx
 589 04e2 5D       		popq	%rbp
 590 04e3 415C     		popq	%r12
GAS LISTING /tmp/ccIWwvs6.s 			page 15


 591 04e5 415D     		popq	%r13
 592 04e7 C3       		ret
 593              		.cfi_endproc
 594              	.LFE689:
 595              		.size	KCipherVecAesNiEncryptOfb, .-KCipherVecAesNiEncryptOfb
 596 04e8 0F1F8400 		.p2align 4,,15
 596      00000000 
 597              		.type	KCipherVecAesNiEncryptEcb, @function
 598              	KCipherVecAesNiEncryptEcb:
 599              	.LFB681:
 600              		.cfi_startproc
 601 04f0 4155     		pushq	%r13
 602              		.cfi_def_cfa_offset 16
 603 04f2 4154     		pushq	%r12
 604              		.cfi_def_cfa_offset 24
 605 04f4 55       		pushq	%rbp
 606              		.cfi_def_cfa_offset 32
 607 04f5 89CD     		movl	%ecx, %ebp
 608              		.cfi_offset 6, -32
 609              		.cfi_offset 12, -24
 610              		.cfi_offset 13, -16
 611 04f7 53       		pushq	%rbx
 612              		.cfi_def_cfa_offset 40
 613 04f8 4889FB   		movq	%rdi, %rbx
 614              		.cfi_offset 3, -40
 615 04fb 4883EC08 		subq	$8, %rsp
 616              		.cfi_def_cfa_offset 48
 617 04ff 85C9     		testl	%ecx, %ecx
 618 0501 7434     		je	.L77
 619 0503 4989F5   		movq	%rsi, %r13
 620 0506 4989D4   		movq	%rdx, %r12
 621 0509 0F1F8000 		.p2align 4,,10
 621      000000
 622              		.p2align 3
 623              	.L78:
 624 0510 488B4348 		movq	72(%rbx), %rax
 625 0514 4C89EF   		movq	%r13, %rdi
 626              	#APP
 627              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 628              		movdqu (%rdi),%xmm0
 629              	# 0 "" 2
 630              	#NO_APP
 631 051b 488B7B18 		movq	24(%rbx), %rdi
 632 051f FF5030   		call	*48(%rax)
 633 0522 4C89E7   		movq	%r12, %rdi
 634              	#APP
 635              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 636              		movdqu %xmm0,(%rdi)
 637              	# 0 "" 2
 638              	#NO_APP
 639 0529 8B4304   		mov	4(%rbx), %eax
 640 052c 4901C5   		addq	%rax, %r13
 641 052f 4901C4   		addq	%rax, %r12
 642 0532 83ED01   		subl	$1, %ebp
 643 0535 75D9     		jne	.L78
 644              	.L77:
 645 0537 4883C408 		addq	$8, %rsp
GAS LISTING /tmp/ccIWwvs6.s 			page 16


 646 053b 31C0     		xorl	%eax, %eax
 647 053d 5B       		popq	%rbx
 648 053e 5D       		popq	%rbp
 649 053f 415C     		popq	%r12
 650 0541 415D     		popq	%r13
 651 0543 C3       		ret
 652              		.cfi_endproc
 653              	.LFE681:
 654              		.size	KCipherVecAesNiEncryptEcb, .-KCipherVecAesNiEncryptEcb
 655 0544 6666662E 		.p2align 4,,15
 655      0F1F8400 
 655      00000000 
 656              		.type	KCipherVecAesNiEncryptCbc, @function
 657              	KCipherVecAesNiEncryptCbc:
 658              	.LFB683:
 659              		.cfi_startproc
 660 0550 4155     		pushq	%r13
 661              		.cfi_def_cfa_offset 16
 662 0552 4154     		pushq	%r12
 663              		.cfi_def_cfa_offset 24
 664 0554 55       		pushq	%rbp
 665              		.cfi_def_cfa_offset 32
 666 0555 89CD     		movl	%ecx, %ebp
 667              		.cfi_offset 6, -32
 668              		.cfi_offset 12, -24
 669              		.cfi_offset 13, -16
 670 0557 53       		pushq	%rbx
 671              		.cfi_def_cfa_offset 40
 672 0558 4889FB   		movq	%rdi, %rbx
 673              		.cfi_offset 3, -40
 674 055b 4883EC08 		subq	$8, %rsp
 675              		.cfi_def_cfa_offset 48
 676 055f 488B7F28 		movq	40(%rdi), %rdi
 677              	#APP
 678              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 679              		movdqu (%rdi),%xmm1
 680              	# 0 "" 2
 681              	#NO_APP
 682 0567 85C9     		testl	%ecx, %ecx
 683 0569 7440     		je	.L82
 684 056b 4989F5   		movq	%rsi, %r13
 685 056e 4989D4   		movq	%rdx, %r12
 686              		.p2align 4,,10
 687 0571 0F1F8000 		.p2align 3
 687      000000
 688              	.L83:
 689 0578 488B4348 		movq	72(%rbx), %rax
 690 057c 4C89EF   		movq	%r13, %rdi
 691              	#APP
 692              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 693              		movdqu (%rdi),%xmm0
 694              	# 0 "" 2
 695              	#NO_APP
 696 0583 488B7B18 		movq	24(%rbx), %rdi
 697 0587 660FEFC1 		pxor	%xmm1, %xmm0
 698 058b FF5030   		call	*48(%rax)
 699 058e 4C89E7   		movq	%r12, %rdi
GAS LISTING /tmp/ccIWwvs6.s 			page 17


 700 0591 660F6FC8 		movdqa	%xmm0, %xmm1
 701              	#APP
 702              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 703              		movdqu %xmm0,(%rdi)
 704              	# 0 "" 2
 705              	#NO_APP
 706 0599 8B4304   		mov	4(%rbx), %eax
 707 059c 4901C5   		addq	%rax, %r13
 708 059f 4901C4   		addq	%rax, %r12
 709 05a2 83ED01   		subl	$1, %ebp
 710 05a5 75D1     		jne	.L83
 711 05a7 488B7B28 		movq	40(%rbx), %rdi
 712              	.L82:
 713              	#APP
 714              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 715              		movdqu %xmm1,(%rdi)
 716              	# 0 "" 2
 717              	#NO_APP
 718 05af 4883C408 		addq	$8, %rsp
 719 05b3 31C0     		xorl	%eax, %eax
 720 05b5 5B       		popq	%rbx
 721 05b6 5D       		popq	%rbp
 722 05b7 415C     		popq	%r12
 723 05b9 415D     		popq	%r13
 724 05bb C3       		ret
 725              		.cfi_endproc
 726              	.LFE683:
 727              		.size	KCipherVecAesNiEncryptCbc, .-KCipherVecAesNiEncryptCbc
 728 05bc 0F1F4000 		.p2align 4,,15
 729              		.type	KCipherVecAesNiEncryptPcbc, @function
 730              	KCipherVecAesNiEncryptPcbc:
 731              	.LFB685:
 732              		.cfi_startproc
 733 05c0 4155     		pushq	%r13
 734              		.cfi_def_cfa_offset 16
 735 05c2 4154     		pushq	%r12
 736              		.cfi_def_cfa_offset 24
 737 05c4 55       		pushq	%rbp
 738              		.cfi_def_cfa_offset 32
 739 05c5 89CD     		movl	%ecx, %ebp
 740              		.cfi_offset 6, -32
 741              		.cfi_offset 12, -24
 742              		.cfi_offset 13, -16
 743 05c7 53       		pushq	%rbx
 744              		.cfi_def_cfa_offset 40
 745 05c8 4889FB   		movq	%rdi, %rbx
 746              		.cfi_offset 3, -40
 747 05cb 4883EC18 		subq	$24, %rsp
 748              		.cfi_def_cfa_offset 64
 749 05cf 488B4728 		movq	40(%rdi), %rax
 750 05d3 85C9     		testl	%ecx, %ecx
 751 05d5 660F6F10 		movdqa	(%rax), %xmm2
 752 05d9 7452     		je	.L87
 753 05db 4989F5   		movq	%rsi, %r13
 754 05de 4989D4   		movq	%rdx, %r12
 755              		.p2align 4,,10
 756 05e1 0F1F8000 		.p2align 3
GAS LISTING /tmp/ccIWwvs6.s 			page 18


 756      000000
 757              	.L88:
 758 05e8 488B4348 		movq	72(%rbx), %rax
 759 05ec 660F6FC2 		movdqa	%xmm2, %xmm0
 760 05f0 4C89EF   		movq	%r13, %rdi
 761              	#APP
 762              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 763              		movdqu (%rdi),%xmm1
 764              	# 0 "" 2
 765              	#NO_APP
 766 05f7 488B7B18 		movq	24(%rbx), %rdi
 767 05fb 660FEFC1 		pxor	%xmm1, %xmm0
 768 05ff 660F7F0C 		movdqa	%xmm1, (%rsp)
 768      24
 769 0604 FF5030   		call	*48(%rax)
 770 0607 4C89E7   		movq	%r12, %rdi
 771 060a 660F6F0C 		movdqa	(%rsp), %xmm1
 771      24
 772 060f 660F6FD1 		movdqa	%xmm1, %xmm2
 773 0613 660FEFD0 		pxor	%xmm0, %xmm2
 774              	#APP
 775              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 776              		movdqu %xmm0,(%rdi)
 777              	# 0 "" 2
 778              	#NO_APP
 779 061b 8B4304   		mov	4(%rbx), %eax
 780 061e 4901C5   		addq	%rax, %r13
 781 0621 4901C4   		addq	%rax, %r12
 782 0624 83ED01   		subl	$1, %ebp
 783 0627 75BF     		jne	.L88
 784 0629 488B4328 		movq	40(%rbx), %rax
 785              	.L87:
 786 062d 660F7F10 		movdqa	%xmm2, (%rax)
 787 0631 4883C418 		addq	$24, %rsp
 788 0635 31C0     		xorl	%eax, %eax
 789 0637 5B       		popq	%rbx
 790 0638 5D       		popq	%rbp
 791 0639 415C     		popq	%r12
 792 063b 415D     		popq	%r13
 793 063d C3       		ret
 794              		.cfi_endproc
 795              	.LFE685:
 796              		.size	KCipherVecAesNiEncryptPcbc, .-KCipherVecAesNiEncryptPcbc
 797 063e 6690     		.p2align 4,,15
 798              		.type	KCipherVecAesNiEncryptCfb, @function
 799              	KCipherVecAesNiEncryptCfb:
 800              	.LFB687:
 801              		.cfi_startproc
 802 0640 4155     		pushq	%r13
 803              		.cfi_def_cfa_offset 16
 804 0642 4154     		pushq	%r12
 805              		.cfi_def_cfa_offset 24
 806 0644 55       		pushq	%rbp
 807              		.cfi_def_cfa_offset 32
 808 0645 89CD     		movl	%ecx, %ebp
 809              		.cfi_offset 6, -32
 810              		.cfi_offset 12, -24
GAS LISTING /tmp/ccIWwvs6.s 			page 19


 811              		.cfi_offset 13, -16
 812 0647 53       		pushq	%rbx
 813              		.cfi_def_cfa_offset 40
 814 0648 4889FB   		movq	%rdi, %rbx
 815              		.cfi_offset 3, -40
 816 064b 4883EC08 		subq	$8, %rsp
 817              		.cfi_def_cfa_offset 48
 818 064f 488B4728 		movq	40(%rdi), %rax
 819 0653 85C9     		testl	%ecx, %ecx
 820 0655 660F6F00 		movdqa	(%rax), %xmm0
 821 0659 7440     		je	.L92
 822 065b 4989F5   		movq	%rsi, %r13
 823 065e 4989D4   		movq	%rdx, %r12
 824              		.p2align 4,,10
 825 0661 0F1F8000 		.p2align 3
 825      000000
 826              	.L93:
 827 0668 488B4348 		movq	72(%rbx), %rax
 828 066c 488B7B18 		movq	24(%rbx), %rdi
 829 0670 FF5030   		call	*48(%rax)
 830 0673 660F6FC8 		movdqa	%xmm0, %xmm1
 831 0677 4C89EF   		movq	%r13, %rdi
 832              	#APP
 833              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 834              		movdqu (%rdi),%xmm0
 835              	# 0 "" 2
 836              	#NO_APP
 837 067e 4C89E7   		movq	%r12, %rdi
 838 0681 660FEFC1 		pxor	%xmm1, %xmm0
 839              	#APP
 840              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 841              		movdqu %xmm0,(%rdi)
 842              	# 0 "" 2
 843              	#NO_APP
 844 0689 8B4304   		mov	4(%rbx), %eax
 845 068c 4901C5   		addq	%rax, %r13
 846 068f 4901C4   		addq	%rax, %r12
 847 0692 83ED01   		subl	$1, %ebp
 848 0695 75D1     		jne	.L93
 849 0697 488B4328 		movq	40(%rbx), %rax
 850              	.L92:
 851 069b 660F7F00 		movdqa	%xmm0, (%rax)
 852 069f 4883C408 		addq	$8, %rsp
 853 06a3 31C0     		xorl	%eax, %eax
 854 06a5 5B       		popq	%rbx
 855 06a6 5D       		popq	%rbp
 856 06a7 415C     		popq	%r12
 857 06a9 415D     		popq	%r13
 858 06ab C3       		ret
 859              		.cfi_endproc
 860              	.LFE687:
 861              		.size	KCipherVecAesNiEncryptCfb, .-KCipherVecAesNiEncryptCfb
 862 06ac 0F1F4000 		.p2align 4,,15
 863              		.type	KCipherVecAesNiDecryptCfb, @function
 864              	KCipherVecAesNiDecryptCfb:
 865              	.LFB688:
 866              		.cfi_startproc
GAS LISTING /tmp/ccIWwvs6.s 			page 20


 867 06b0 4155     		pushq	%r13
 868              		.cfi_def_cfa_offset 16
 869 06b2 4154     		pushq	%r12
 870              		.cfi_def_cfa_offset 24
 871 06b4 55       		pushq	%rbp
 872              		.cfi_def_cfa_offset 32
 873 06b5 89CD     		movl	%ecx, %ebp
 874              		.cfi_offset 6, -32
 875              		.cfi_offset 12, -24
 876              		.cfi_offset 13, -16
 877 06b7 53       		pushq	%rbx
 878              		.cfi_def_cfa_offset 40
 879 06b8 4889FB   		movq	%rdi, %rbx
 880              		.cfi_offset 3, -40
 881 06bb 4883EC08 		subq	$8, %rsp
 882              		.cfi_def_cfa_offset 48
 883 06bf 488B4728 		movq	40(%rdi), %rax
 884 06c3 85C9     		testl	%ecx, %ecx
 885 06c5 660F6F08 		movdqa	(%rax), %xmm1
 886 06c9 7440     		je	.L97
 887 06cb 4989F5   		movq	%rsi, %r13
 888 06ce 4989D4   		movq	%rdx, %r12
 889              		.p2align 4,,10
 890 06d1 0F1F8000 		.p2align 3
 890      000000
 891              	.L98:
 892 06d8 488B4348 		movq	72(%rbx), %rax
 893 06dc 488B7B18 		movq	24(%rbx), %rdi
 894 06e0 660F6FC1 		movdqa	%xmm1, %xmm0
 895 06e4 FF5030   		call	*48(%rax)
 896 06e7 4C89EF   		movq	%r13, %rdi
 897              	#APP
 898              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 899              		movdqu (%rdi),%xmm1
 900              	# 0 "" 2
 901              	#NO_APP
 902 06ee 4C89E7   		movq	%r12, %rdi
 903 06f1 660FEFC1 		pxor	%xmm1, %xmm0
 904              	#APP
 905              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 906              		movdqu %xmm0,(%rdi)
 907              	# 0 "" 2
 908              	#NO_APP
 909 06f9 8B4304   		mov	4(%rbx), %eax
 910 06fc 4901C5   		addq	%rax, %r13
 911 06ff 4901C4   		addq	%rax, %r12
 912 0702 83ED01   		subl	$1, %ebp
 913 0705 75D1     		jne	.L98
 914 0707 488B4328 		movq	40(%rbx), %rax
 915              	.L97:
 916 070b 660F7F08 		movdqa	%xmm1, (%rax)
 917 070f 4883C408 		addq	$8, %rsp
 918 0713 31C0     		xorl	%eax, %eax
 919 0715 5B       		popq	%rbx
 920 0716 5D       		popq	%rbp
 921 0717 415C     		popq	%r12
 922 0719 415D     		popq	%r13
GAS LISTING /tmp/ccIWwvs6.s 			page 21


 923 071b C3       		ret
 924              		.cfi_endproc
 925              	.LFE688:
 926              		.size	KCipherVecAesNiDecryptCfb, .-KCipherVecAesNiDecryptCfb
 927 071c 0F1F4000 		.p2align 4,,15
 928              		.type	KCipherVecAesNiDecryptOfb, @function
 929              	KCipherVecAesNiDecryptOfb:
 930              	.LFB690:
 931              		.cfi_startproc
 932 0720 4155     		pushq	%r13
 933              		.cfi_def_cfa_offset 16
 934 0722 4154     		pushq	%r12
 935              		.cfi_def_cfa_offset 24
 936 0724 55       		pushq	%rbp
 937              		.cfi_def_cfa_offset 32
 938 0725 89CD     		movl	%ecx, %ebp
 939              		.cfi_offset 6, -32
 940              		.cfi_offset 12, -24
 941              		.cfi_offset 13, -16
 942 0727 53       		pushq	%rbx
 943              		.cfi_def_cfa_offset 40
 944 0728 4889FB   		movq	%rdi, %rbx
 945              		.cfi_offset 3, -40
 946 072b 4883EC08 		subq	$8, %rsp
 947              		.cfi_def_cfa_offset 48
 948 072f 488B4728 		movq	40(%rdi), %rax
 949 0733 85C9     		testl	%ecx, %ecx
 950 0735 660F6F00 		movdqa	(%rax), %xmm0
 951 0739 743C     		je	.L102
 952 073b 4989F5   		movq	%rsi, %r13
 953 073e 4989D4   		movq	%rdx, %r12
 954              		.p2align 4,,10
 955 0741 0F1F8000 		.p2align 3
 955      000000
 956              	.L103:
 957 0748 488B4348 		movq	72(%rbx), %rax
 958 074c 488B7B18 		movq	24(%rbx), %rdi
 959 0750 FF5030   		call	*48(%rax)
 960 0753 4C89EF   		movq	%r13, %rdi
 961              	#APP
 962              	# 78 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 963              		movdqu (%rdi),%xmm1
 964              	# 0 "" 2
 965              	#NO_APP
 966 075a 4C89E7   		movq	%r12, %rdi
 967 075d 660FEFC8 		pxor	%xmm0, %xmm1
 968              	#APP
 969              	# 101 "/home/rodarmer/sra_sdk-2.2.2a/libs/krypto/cipher-vec.c" 1
 970              		movdqu %xmm1,(%rdi)
 971              	# 0 "" 2
 972              	#NO_APP
 973 0765 8B4304   		mov	4(%rbx), %eax
 974 0768 4901C5   		addq	%rax, %r13
 975 076b 4901C4   		addq	%rax, %r12
 976 076e 83ED01   		subl	$1, %ebp
 977 0771 75D5     		jne	.L103
 978 0773 488B4328 		movq	40(%rbx), %rax
GAS LISTING /tmp/ccIWwvs6.s 			page 22


 979              	.L102:
 980 0777 660F7F00 		movdqa	%xmm0, (%rax)
 981 077b 4883C408 		addq	$8, %rsp
 982 077f 31C0     		xorl	%eax, %eax
 983 0781 5B       		popq	%rbx
 984 0782 5D       		popq	%rbp
 985 0783 415C     		popq	%r12
 986 0785 415D     		popq	%r13
 987 0787 C3       		ret
 988              		.cfi_endproc
 989              	.LFE690:
 990              		.size	KCipherVecAesNiDecryptOfb, .-KCipherVecAesNiDecryptOfb
 991              	.globl KCipherVecAesNiClassName
 992              		.section	.rodata
 993              		.type	KCipherVecAesNiClassName, @object
 994              		.size	KCipherVecAesNiClassName, 12
 995              	KCipherVecAesNiClassName:
 996 0000 43495048 		.string	"CIPHER_IMPL"
 996      45525F49 
 996      4D504C00 
 997              		.section	.data.rel.local,"aw",@progbits
 998              		.align 32
 999              		.type	KCipherVecAesNi_vt_v1, @object
 1000              		.size	KCipherVecAesNi_vt_v1, 176
 1001              	KCipherVecAesNi_vt_v1:
 1002 0000 01000000 		.long	1
 1003 0004 00000000 		.long	0
 1004 0008 00000000 		.quad	KCipherVecAesNiDestroy
 1004      00000000 
 1005 0010 00000000 		.quad	KCipherVecAesNiSetEncryptKey
 1005      00000000 
 1006 0018 00000000 		.quad	KCipherVecAesNiSetDecryptKey
 1006      00000000 
 1007 0020 00000000 		.quad	KCipherVecAesNiSetEncryptIvec
 1007      00000000 
 1008 0028 00000000 		.quad	KCipherVecAesNiSetDecryptIvec
 1008      00000000 
 1009 0030 00000000 		.quad	KCipherVecAesNiSetEncryptCounterFunc
 1009      00000000 
 1010 0038 00000000 		.quad	KCipherVecAesNiSetDecryptCounterFunc
 1010      00000000 
 1011 0040 00000000 		.quad	KCipherVecAesNiEncrypt
 1011      00000000 
 1012 0048 00000000 		.quad	KCipherVecAesNiDecrypt
 1012      00000000 
 1013 0050 00000000 		.quad	KCipherVecAesNiEncryptEcb
 1013      00000000 
 1014 0058 00000000 		.quad	KCipherVecAesNiDecryptEcb
 1014      00000000 
 1015 0060 00000000 		.quad	KCipherVecAesNiEncryptCbc
 1015      00000000 
 1016 0068 00000000 		.quad	KCipherVecAesNiDecryptCbc
 1016      00000000 
 1017 0070 00000000 		.quad	KCipherVecAesNiEncryptPcbc
 1017      00000000 
 1018 0078 00000000 		.quad	KCipherVecAesNiDecryptPcbc
 1018      00000000 
GAS LISTING /tmp/ccIWwvs6.s 			page 23


 1019 0080 00000000 		.quad	KCipherVecAesNiEncryptCfb
 1019      00000000 
 1020 0088 00000000 		.quad	KCipherVecAesNiDecryptCfb
 1020      00000000 
 1021 0090 00000000 		.quad	KCipherVecAesNiEncryptOfb
 1021      00000000 
 1022 0098 00000000 		.quad	KCipherVecAesNiDecryptOfb
 1022      00000000 
 1023 00a0 00000000 		.quad	KCipherVecAesNiEncryptCtr
 1023      00000000 
 1024 00a8 00000000 		.quad	KCipherVecAesNiDecryptCtr
 1024      00000000 
 1025              		.ident	"GCC: (GNU) 4.4.2"
 1026              		.section	.note.GNU-stack,"",@progbits
GAS LISTING /tmp/ccIWwvs6.s 			page 24


DEFINED SYMBOLS
                            *ABS*:0000000000000000 cipher-vec.c
     /tmp/ccIWwvs6.s:5      .text:0000000000000000 KCipherVecAesNiSetEncryptKey
     /tmp/ccIWwvs6.s:25     .text:0000000000000020 KCipherVecAesNiSetDecryptKey
     /tmp/ccIWwvs6.s:45     .text:0000000000000040 KCipherVecAesNiSetEncryptCounterFunc
     /tmp/ccIWwvs6.s:56     .text:0000000000000050 KCipherVecAesNiSetDecryptCounterFunc
     /tmp/ccIWwvs6.s:67     .text:0000000000000060 KCipherVecAesNiEncrypt
     /tmp/ccIWwvs6.s:106    .text:00000000000000a0 KCipherVecAesNiDecrypt
     /tmp/ccIWwvs6.s:145    .text:00000000000000e0 KCipherVecAesNiDecryptEcb
     /tmp/ccIWwvs6.s:204    .text:0000000000000140 KCipherVecAesNiDecryptCbc
     /tmp/ccIWwvs6.s:278    .text:00000000000001d0 KCipherVecAesNiDecryptPcbc
     /tmp/ccIWwvs6.s:344    .text:0000000000000250 KCipherVecAesNiEncryptCtr
     /tmp/ccIWwvs6.s:354    .text:0000000000000260 KCipherVecAesNiDecryptCtr
     /tmp/ccIWwvs6.s:365    .text:0000000000000270 KCipherVecAesNiMake
     /tmp/ccIWwvs6.s:995    .rodata:0000000000000000 KCipherVecAesNiClassName
     /tmp/ccIWwvs6.s:1001   .data.rel.local:0000000000000000 KCipherVecAesNi_vt_v1
     /tmp/ccIWwvs6.s:472    .text:0000000000000400 KCipherVecAesNiSetDecryptIvec
     /tmp/ccIWwvs6.s:489    .text:0000000000000420 KCipherVecAesNiSetEncryptIvec
     /tmp/ccIWwvs6.s:506    .text:0000000000000440 KCipherVecAesNiDestroy
     /tmp/ccIWwvs6.s:534    .text:0000000000000480 KCipherVecAesNiEncryptOfb
     /tmp/ccIWwvs6.s:598    .text:00000000000004f0 KCipherVecAesNiEncryptEcb
     /tmp/ccIWwvs6.s:657    .text:0000000000000550 KCipherVecAesNiEncryptCbc
     /tmp/ccIWwvs6.s:730    .text:00000000000005c0 KCipherVecAesNiEncryptPcbc
     /tmp/ccIWwvs6.s:799    .text:0000000000000640 KCipherVecAesNiEncryptCfb
     /tmp/ccIWwvs6.s:864    .text:00000000000006b0 KCipherVecAesNiDecryptCfb
     /tmp/ccIWwvs6.s:929    .text:0000000000000720 KCipherVecAesNiDecryptOfb

UNDEFINED SYMBOLS
_GLOBAL_OFFSET_TABLE_
KNullBlockCipherVecAesNiMake
calloc
KCipherInit
KAESBlockCipherVecAesNiMake
memcpy
KCipherDestroy
free
